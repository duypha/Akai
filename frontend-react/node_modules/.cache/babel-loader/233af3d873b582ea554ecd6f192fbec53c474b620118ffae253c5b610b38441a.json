{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\anhdu\\\\Projects\\\\it-support-agent\\\\frontend-react\\\\src\\\\contexts\\\\ChatContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useCallback } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatContext = /*#__PURE__*/createContext(undefined);\nexport function ChatProvider({\n  children\n}) {\n  _s();\n  const [session, setSession] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [isConnected, setIsConnected] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const createSession = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const response = await fetch('/api/session/create', {\n        method: 'POST'\n      });\n      if (!response.ok) throw new Error('Failed to create session');\n      const data = await response.json();\n      setSession({\n        id: data.session_id,\n        code: data.code,\n        createdAt: new Date(data.created_at),\n        messages: []\n      });\n\n      // Add welcome message\n      const welcomeMessage = {\n        id: crypto.randomUUID(),\n        role: 'assistant',\n        content: 'Hello, I\\'m Akai.\\n\\nHow can I help you today?',\n        timestamp: new Date(),\n        status: 'sent'\n      };\n      setMessages([welcomeMessage]);\n      setIsConnected(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to create session');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n  const sendMessage = useCallback(async content => {\n    if (!session || !content.trim()) return;\n    const userMessage = {\n      id: crypto.randomUUID(),\n      role: 'user',\n      content: content.trim(),\n      timestamp: new Date(),\n      status: 'sending'\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setIsLoading(true);\n    try {\n      const formData = new FormData();\n      formData.append('message', content.trim());\n      formData.append('session_id', session.id);\n      const response = await fetch('/api/chat', {\n        method: 'POST',\n        body: formData\n      });\n      if (!response.ok) throw new Error('Failed to send message');\n      const data = await response.json();\n\n      // Update user message status\n      setMessages(prev => prev.map(msg => msg.id === userMessage.id ? {\n        ...msg,\n        status: 'sent'\n      } : msg));\n\n      // Add assistant response - split by double newlines for multiple bubbles\n      const responseChunks = data.response.split(/\\n\\n+/).filter(chunk => chunk.trim());\n      responseChunks.forEach((chunk, index) => {\n        setTimeout(() => {\n          const assistantMessage = {\n            id: crypto.randomUUID(),\n            role: 'assistant',\n            content: chunk.trim(),\n            timestamp: new Date(),\n            status: 'sent'\n          };\n          setMessages(prev => [...prev, assistantMessage]);\n        }, index * 150); // Stagger messages for effect\n      });\n    } catch (err) {\n      setMessages(prev => prev.map(msg => msg.id === userMessage.id ? {\n        ...msg,\n        status: 'error'\n      } : msg));\n      setError(err instanceof Error ? err.message : 'Failed to send message');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [session]);\n  const addMessage = useCallback(message => {\n    setMessages(prev => [...prev, message]);\n  }, []);\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(ChatContext.Provider, {\n    value: {\n      session,\n      messages,\n      isConnected,\n      isLoading,\n      error,\n      createSession,\n      sendMessage,\n      addMessage,\n      clearError\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatProvider, \"obHslsQeMcncV+4NROKVUqSibyI=\");\n_c = ChatProvider;\nexport function useChat() {\n  _s2();\n  const context = useContext(ChatContext);\n  if (!context) {\n    throw new Error('useChat must be used within a ChatProvider');\n  }\n  return context;\n}\n_s2(useChat, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"ChatProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useCallback","jsxDEV","_jsxDEV","ChatContext","undefined","ChatProvider","children","_s","session","setSession","messages","setMessages","isConnected","setIsConnected","isLoading","setIsLoading","error","setError","createSession","response","fetch","method","ok","Error","data","json","id","session_id","code","createdAt","Date","created_at","welcomeMessage","crypto","randomUUID","role","content","timestamp","status","err","message","sendMessage","trim","userMessage","prev","formData","FormData","append","body","map","msg","responseChunks","split","filter","chunk","forEach","index","setTimeout","assistantMessage","addMessage","clearError","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useChat","_s2","context","$RefreshReg$"],"sources":["C:/Users/anhdu/Projects/it-support-agent/frontend-react/src/contexts/ChatContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useCallback, ReactNode } from 'react';\r\nimport { Message, Session } from '../types';\r\n\r\ninterface ChatContextType {\r\n  session: Session | null;\r\n  messages: Message[];\r\n  isConnected: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  createSession: () => Promise<void>;\r\n  sendMessage: (content: string) => Promise<void>;\r\n  addMessage: (message: Message) => void;\r\n  clearError: () => void;\r\n}\r\n\r\nconst ChatContext = createContext<ChatContextType | undefined>(undefined);\r\n\r\ninterface ChatProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function ChatProvider({ children }: ChatProviderProps) {\r\n  const [session, setSession] = useState<Session | null>(null);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const createSession = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      const response = await fetch('/api/session/create', { method: 'POST' });\r\n      if (!response.ok) throw new Error('Failed to create session');\r\n\r\n      const data = await response.json();\r\n\r\n      setSession({\r\n        id: data.session_id,\r\n        code: data.code,\r\n        createdAt: new Date(data.created_at),\r\n        messages: []\r\n      });\r\n\r\n      // Add welcome message\r\n      const welcomeMessage: Message = {\r\n        id: crypto.randomUUID(),\r\n        role: 'assistant',\r\n        content: 'Hello, I\\'m Akai.\\n\\nHow can I help you today?',\r\n        timestamp: new Date(),\r\n        status: 'sent'\r\n      };\r\n      setMessages([welcomeMessage]);\r\n      setIsConnected(true);\r\n\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create session');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const sendMessage = useCallback(async (content: string) => {\r\n    if (!session || !content.trim()) return;\r\n\r\n    const userMessage: Message = {\r\n      id: crypto.randomUUID(),\r\n      role: 'user',\r\n      content: content.trim(),\r\n      timestamp: new Date(),\r\n      status: 'sending'\r\n    };\r\n\r\n    setMessages(prev => [...prev, userMessage]);\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('message', content.trim());\r\n      formData.append('session_id', session.id);\r\n\r\n      const response = await fetch('/api/chat', {\r\n        method: 'POST',\r\n        body: formData\r\n      });\r\n\r\n      if (!response.ok) throw new Error('Failed to send message');\r\n\r\n      const data = await response.json();\r\n\r\n      // Update user message status\r\n      setMessages(prev => prev.map(msg =>\r\n        msg.id === userMessage.id ? { ...msg, status: 'sent' } : msg\r\n      ));\r\n\r\n      // Add assistant response - split by double newlines for multiple bubbles\r\n      const responseChunks = data.response.split(/\\n\\n+/).filter((chunk: string) => chunk.trim());\r\n\r\n      responseChunks.forEach((chunk: string, index: number) => {\r\n        setTimeout(() => {\r\n          const assistantMessage: Message = {\r\n            id: crypto.randomUUID(),\r\n            role: 'assistant',\r\n            content: chunk.trim(),\r\n            timestamp: new Date(),\r\n            status: 'sent'\r\n          };\r\n          setMessages(prev => [...prev, assistantMessage]);\r\n        }, index * 150); // Stagger messages for effect\r\n      });\r\n\r\n    } catch (err) {\r\n      setMessages(prev => prev.map(msg =>\r\n        msg.id === userMessage.id ? { ...msg, status: 'error' } : msg\r\n      ));\r\n      setError(err instanceof Error ? err.message : 'Failed to send message');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [session]);\r\n\r\n  const addMessage = useCallback((message: Message) => {\r\n    setMessages(prev => [...prev, message]);\r\n  }, []);\r\n\r\n  const clearError = useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n\r\n  return (\r\n    <ChatContext.Provider value={{\r\n      session,\r\n      messages,\r\n      isConnected,\r\n      isLoading,\r\n      error,\r\n      createSession,\r\n      sendMessage,\r\n      addMessage,\r\n      clearError\r\n    }}>\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useChat() {\r\n  const context = useContext(ChatContext);\r\n  if (!context) {\r\n    throw new Error('useChat must be used within a ChatProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}